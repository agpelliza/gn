#!/usr/bin/env ruby

require_relative "../lib/gn"

name = ARGV.first.to_s.strip

if name.empty? || name == "-h" || name == "--help"

  puts <<-USAGE
  Usage: gn <name>

  Run the <name> generator found in ~/.gn/<name>.

  See http://lucasefe.github.com/gn for more information.
  USAGE

else
  require "fileutils"

  gn = Gn.new(name)

  # Load edited plan.
  gn.load!

  # Process each blueprint.
  gn.blueprints.each do |blueprint|

    # Create destination directory.
    FileUtils.mkdir_p(File.dirname(blueprint.destination))

    # Write generated template.
    File.open(blueprint.destination, "w") do |file|
      file.write blueprint.render
    end
  end
end
